<div class="grid">
  <!-- ######### LIVE GRAPH SECTION ######### -->

  <div class="active-graph-selector">
    <div class="active-graph-selector__title">Active Graphs</div>
    <div class="active-graph-selector__inner">
      <div
        class="active-graph-selector__inner__item"
        *ngFor="let vital of vitals | callback : filterActiveVitals"
        draggable="true"
        (dragstart)="onDragStart($event, vital.vitalName)"
      >
        <app-vitals
          class="inactive"
          [unit]="vital.unit"
          [vitalName]="vital.vitalName"
          [maxVal]="vital.maxVal"
          [minVal]="vital.minVal"
          [active]="vital.active"
          [size]="'small'"
          [color]="vital.color"
          [subscribeLive]="true"
        ></app-vitals>
      </div>
    </div>
  </div>

  <!-- ACTIVE GRAPHS DISPLAYED HERE -->
  <div class="active-graph-container">
    <div
      class="active-graph-lg"
      (dragover)="allowDrop($event)"
      (drop)="onDrop($event, 0)"
    >
      <ng-container *ngIf="slots[0]; else placeholder0">
        <app-vitals
          [unit]="slots[0].unit"
          [active]="true"
          [maxVal]="slots[0].maxVal"
          [minVal]="slots[0].minVal"
          [vitalName]="slots[0].vitalName"
          [numVal]="slots[0].numVal"
          (valueChange)="onSlotValueChange($event, 0)"
          [size]="'lg'"
          [color]="slots[0].color"
        ></app-vitals>
      </ng-container>
      <ng-template #placeholder0>LG</ng-template>
    </div>
    <div
      class="active-graph-sm-1"
      (dragover)="allowDrop($event)"
      (drop)="onDrop($event, 1)"
    >
      <ng-container *ngIf="slots[1]; else placeholder1">
        <app-vitals
          [unit]="slots[1].unit"
          [active]="true"
          [maxVal]="slots[1].maxVal"
          [minVal]="slots[1].minVal"
          [vitalName]="slots[1].vitalName"
          [numVal]="slots[1].numVal"
          (valueChange)="onSlotValueChange($event, 1)"
          [size]="'sm'"
          [color]="slots[1].color"
        ></app-vitals>
      </ng-container>
      <ng-template #placeholder1>SM 1</ng-template>
    </div>
    <div
      class="active-graph-sm-2"
      (dragover)="allowDrop($event)"
      (drop)="onDrop($event, 2)"
    >
      <ng-container *ngIf="slots[2]; else placeholder2">
        <app-vitals
          [unit]="slots[2].unit"
          [active]="true"
          [maxVal]="slots[2].maxVal"
          [minVal]="slots[2].minVal"
          [vitalName]="slots[2].vitalName"
          [numVal]="slots[2].numVal"
          (valueChange)="onSlotValueChange($event, 2)"
          [size]="'sm'"
          [color]="slots[2].color"
        ></app-vitals>
      </ng-container>
      <ng-template #placeholder2>SM 2</ng-template>
    </div>
    <div
      class="active-graph-sm-3"
      (dragover)="allowDrop($event)"
      (drop)="onDrop($event, 3)"
    >
      <ng-container *ngIf="slots[3]; else placeholder3">
        <app-vitals
          [unit]="slots[3].unit"
          [active]="true"
          [maxVal]="slots[3].maxVal"
          [minVal]="slots[3].minVal"
          [vitalName]="slots[3].vitalName"
          [numVal]="slots[3].numVal"
          (valueChange)="onSlotValueChange($event, 3)"
          [size]="'sm'"
          [color]="slots[3].color"
        ></app-vitals>
      </ng-container>
      <ng-template #placeholder3>SM 3</ng-template>
    </div>
    <div
      class="active-graph-sm-4"
      (dragover)="allowDrop($event)"
      (drop)="onDrop($event, 4)"
    >
      <ng-container *ngIf="slots[4]; else placeholder4">
        <app-vitals
          [unit]="slots[4].unit"
          [active]="true"
          [maxVal]="slots[4].maxVal"
          [minVal]="slots[4].minVal"
          [vitalName]="slots[4].vitalName"
          [numVal]="slots[4].numVal"
          (valueChange)="onSlotValueChange($event, 4)"
          [size]="'sm'"
          [color]="slots[4].color"
        ></app-vitals>
      </ng-container>
      <ng-template #placeholder4>SM 4</ng-template>
    </div>
  </div>

  <!-- ######### TREND GRAPH SECTION ######### -->
  <div class="trend-graph-selector">
    <div class="trend-graph-selector__title">Selection</div>
    <div class="trend-graph-selector__inner">
      <div
        class="trend-graph-selector__inner__element"
        [class.active]="trendFilter === 'essential'"
        (click)="setTrendFilter('essential')"
      >
        <div class="selector-name">Essential</div>
        <div class="selector-icon">
          <svg
            width="48"
            height="48"
            viewBox="0 0 48 48"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4ZM24 6C14.0589 6 6 14.0589 6 24C6 33.9411 14.0589 42 24 42C33.9411 42 42 33.9411 42 24C42 14.0589 33.9411 6 24 6Z"
              fill="currentColor"
            />
            <path
              d="M26 13C26 11.8954 25.1046 11 24 11C22.8954 11 22 11.8954 22 13L22 27C22 28.1046 22.8954 29 24 29C25.1046 29 26 28.1046 26 27L26 13Z"
              fill="currentColor"
            />
            <path
              d="M24 33C25.1046 33 26 33.8954 26 35C26 36.1046 25.1046 37 24 37C22.8954 37 22 36.1046 22 35C22 33.8954 22.8954 33 24 33Z"
              fill="currentColor"
            />
          </svg>
        </div>
      </div>
      <div
        class="trend-graph-selector__inner__element"
        [class.active]="trendFilter === 'heart'"
        (click)="setTrendFilter('heart')"
      >
        <div class="selector-name">Heart</div>
        <div class="selector-icon">
          <svg
            width="48"
            height="48"
            viewBox="0 0 48 48"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M30.0496 9.52364V7C30.0496 6.73478 29.9433 6.48043 29.754 6.29289C29.5648 6.10535 29.3081 6 29.0404 6L24.6966 6.00004C24.1393 6.00005 23.6874 6.44776 23.6874 7.00004V9.43344L22.2014 10.1236L20.2666 7.71934C19.9444 7.31893 19.369 7.22444 18.9336 7.50046L15.5299 9.65838C15.2891 9.81105 15.1249 10.0578 15.0782 10.3372C15.0315 10.6167 15.1065 10.9027 15.2848 11.1242L17.1795 13.4786C17.085 13.5921 16.9853 13.7173 16.885 13.8521C16.6902 14.1137 16.4635 14.4494 16.2719 14.8321C15.5246 14.1605 14.6395 13.6048 13.8044 13.1624C12.8859 12.676 11.9889 12.3063 11.3251 12.0589C10.992 11.9348 10.4234 11.7437 10.2274 11.6797C9.95398 11.6 9.62982 11.6346 9.38664 11.7819C9.14346 11.9292 8.97433 12.1723 8.92128 12.4498L8.01764 17.1765C7.96689 17.4419 8.0267 17.7164 8.18346 17.9375C8.34021 18.1586 8.58057 18.3074 8.84981 18.3501C9.95422 18.5251 10.7886 19.0696 11.36 19.592C11.6445 19.8522 11.8562 20.1003 11.9943 20.2797C12.0134 20.3046 12.0338 20.3323 12.054 20.3603C11.0452 21.885 10.6551 23.6793 10.7178 25.5266C10.8027 28.0283 11.7131 30.6743 13.0789 33.0685C14.4475 35.4676 16.3084 37.6759 18.37 39.2949C20.4174 40.9028 22.7558 42 25.0659 42C27.3703 42 29.7686 40.9085 31.8923 39.2926C34.0322 37.6644 35.9918 35.4312 37.4281 32.9732C40.2505 28.1434 41.2807 21.9328 36.7183 17.934C36.5292 17.7683 36.3537 17.6285 36.1859 17.5069C36.9168 17.4975 37.7563 17.5123 38.734 17.5457L39.7493 17.5805L40 10.8317L38.9965 10.7974C36.4319 10.7097 34.0766 10.8212 31.9386 11.308C31.4066 10.6245 30.8297 10.1119 30.3808 9.76632C30.2613 9.67431 30.1499 9.59342 30.0496 9.52364ZM32.2214 18.143C32.3967 18.0626 32.5796 17.9909 32.7733 17.9272C33.2727 18.2092 33.6715 18.4023 33.9905 18.5568C34.0968 18.6083 34.1945 18.6556 34.2838 18.7003C34.6642 18.8909 34.9616 19.0645 35.3809 19.432C38.8223 22.4483 38.3548 27.3961 35.6814 31.971C34.3699 34.2154 32.5821 36.2461 30.663 37.7063C28.7278 39.1787 26.7557 40 25.0659 40C23.3821 40 21.4768 39.1827 19.6237 37.7275C17.7848 36.2834 16.0886 34.2799 14.8361 32.0843C13.5808 29.8838 12.8062 27.5523 12.7351 25.4593C12.6647 23.3861 13.2795 21.5969 14.751 20.3072C15.5029 19.6481 16.8186 19.3795 18.5099 19.4755C19.6208 19.5386 20.7886 19.7532 21.8632 20.0264L21.8605 20.0317L23.0045 20.3633C24.2121 20.7134 25.6131 21.2689 26.5339 21.6549L25.0761 24.78L21.339 26.4546L17.2966 25.5109L16.8337 27.4576L20.0738 28.214L19.0108 30.8764L20.8878 31.6121L22.23 28.2503L24.4188 27.2695C24.3115 28.4301 24.4978 29.606 24.9702 30.6879L25.3177 31.4837L25.5885 35.4155L27.6022 35.2794L27.3852 32.1276L30.7244 31.7435L30.4917 29.7569L26.9413 30.1652L26.8227 29.8937C26.364 28.8434 26.2829 27.6689 26.5929 26.5665L26.7848 25.8839L28.9641 21.2121C29.0687 21.1056 29.1628 20.9878 29.2439 20.8601C30.1652 19.409 31.1392 18.6393 32.2214 18.143ZM24.7497 18.8178C25.4131 17.671 26.1248 16.7585 26.933 16.0081C27.0974 15.859 27.2668 15.7123 27.4403 15.5682C28.1629 14.9836 28.9624 14.5058 29.8681 14.0904C32.0607 13.0848 34.6929 12.7334 37.9066 12.7707L37.8045 15.5196C34.9585 15.4545 33.0096 15.5859 31.3832 16.3318C29.9268 16.9997 28.6566 18.041 27.535 19.8077C27.5191 19.8326 27.4959 19.8493 27.4735 19.8568C27.4533 19.8636 27.4438 19.8602 27.4398 19.8585C26.7654 19.5741 25.7684 19.17 24.7497 18.8178ZM14.716 18.006C14.5495 18.0761 14.3871 18.1542 14.2295 18.2407L13.636 18.5271C13.5169 18.5914 13.4064 18.6523 13.3049 18.7092L12.7292 18.1223C12.1312 17.5753 11.2824 16.9768 10.1791 16.6177L10.6876 13.9581C11.2884 14.1846 12.0677 14.5102 12.8531 14.9262C13.6769 15.3625 14.4693 15.8784 15.0693 16.4558C15.4205 16.7937 15.6811 17.1284 15.8521 17.4578L14.716 18.006ZM17.9984 17.4573C18.2089 17.4596 18.4183 17.467 18.6254 17.4788C18.8112 17.4893 18.9977 17.5035 19.1844 17.521C20.4611 17.6312 21.7716 17.8895 22.8096 18.1342C23.5338 16.4923 24.8768 15.0745 26.2309 13.9635C27.3595 13.0375 28.5623 12.2708 29.5812 11.7131C29.4265 11.5723 29.2778 11.4498 29.1426 11.3457C28.9587 11.2042 28.5535 10.945 28.5535 10.945C28.5535 10.945 28.0312 10.4344 28.0312 10.0691V8L25.7059 8.00002V10.0691C25.7059 10.457 25.4795 10.81 25.125 10.9746L22.3371 12.2693C21.9143 12.4657 21.4108 12.349 21.1197 11.9873L19.2555 9.67077L17.5612 10.7449L19.2942 12.8983C19.6206 13.3039 19.5798 13.8894 19.2003 14.2467L18.9962 14.4562C18.9962 14.4562 18.6856 14.8026 18.5094 15.0394C18.1223 15.5592 17.8781 16.0608 17.8676 16.4079C17.8614 16.6126 17.8653 16.8927 17.9334 17.2293C17.9572 17.3043 17.9789 17.3804 17.9984 17.4573Z"
              fill="currentColor"
            />
          </svg>
        </div>
      </div>
      <div
        class="trend-graph-selector__inner__element"
        [class.active]="trendFilter === 'brain'"
        (click)="setTrendFilter('brain')"
      >
        <div class="selector-name">Brain</div>
        <div class="selector-icon">
          <svg
            width="48"
            height="48"
            viewBox="0 0 48 48"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M29.5844 22.8731C30.7438 22.8731 31.8763 22.5579 32.8338 21.9687C33.806 22.5568 34.9534 22.8651 36.1242 22.8529L39.8433 21.6331C40.8913 20.8544 41.6107 19.7749 41.8813 18.5754C42.1518 17.3758 41.9569 16.1289 41.3293 15.0433C40.7017 13.9577 39.6794 13.0993 38.4336 12.6118C38.1491 11.4505 37.4326 10.4117 36.4029 9.66789L32.7725 8.5228H32.3638C31.5563 7.46088 30.344 6.70341 28.9574 6.39438L21.1741 6C19.8803 6.09689 18.6603 6.58325 17.7105 7.38081C17.2617 7.28544 16.8023 7.23601 16.3412 7.23346C15.2247 7.23553 14.1327 7.52881 13.1971 8.0779C12.2615 8.62699 11.5222 9.40843 11.0685 10.3279L8.11115 12.216C7.37528 13.1146 6.97913 14.2026 6.98108 15.3194C6.9738 15.7865 7.04266 16.2519 7.18545 16.7009C6.40957 17.6083 5.99236 18.7234 6.00011 19.869C5.99826 21.1976 6.56142 22.4764 7.57375 23.4423C7.65545 24.3935 8.02424 25.3065 8.64022 26.0824C9.2562 26.8583 10.0959 27.4677 11.0685 27.8444C12.1891 28.4776 13.138 29.3292 13.8453 30.3364C14.5527 31.3437 15.0005 32.4811 15.1559 33.6649H22.7915V28.1391C22.7901 27.158 23.0938 26.1962 23.6682 25.3627C24.2425 24.5293 25.0645 23.8576 26.041 23.4238C26.5901 23.2345 26.7252 22.9796 26.8907 22.6673C27.001 22.4592 27.1249 22.2255 27.3937 21.9687C27.6273 22.1124 27.8083 22.2399 27.9652 22.3504C28.4518 22.6929 28.7077 22.8731 29.5844 22.8731ZM34.032 20.3449C34.5652 20.6333 35.18 20.807 35.8225 20.8411L38.8778 19.839C39.4357 19.3535 39.79 18.7515 39.9302 18.1296C40.0877 17.4314 39.9791 16.6979 39.5978 16.0384C39.2129 15.3726 38.5587 14.8026 37.7048 14.4685L36.738 14.0902L36.491 13.0818C36.3463 12.4911 35.9991 11.9204 35.4592 11.4615L32.4646 10.5169H31.3721L30.7718 9.72751C30.296 9.10182 29.5621 8.60824 28.6714 8.3766L21.21 7.99854C20.3583 8.08446 19.584 8.41337 18.9966 8.90662L18.2493 9.5341L17.2948 9.33129C16.9821 9.26484 16.6609 9.22992 16.3376 9.22763C15.5675 9.23033 14.828 9.43391 14.2094 9.79695C13.59 10.1604 13.1326 10.6586 12.862 11.207L12.6151 11.7075L9.48953 13.703C9.14804 14.2036 8.98012 14.7602 8.98108 15.3101L8.98111 15.3274L8.98084 15.3448C8.97696 15.5937 9.01352 15.844 9.09138 16.0889L9.42858 17.1491L8.70555 17.9948C8.22801 18.5533 7.99572 19.2069 8.00006 19.8496L8.00011 19.8577L8.0001 19.8659C7.99906 20.6151 8.31472 21.3791 8.95437 21.9894L9.50169 22.5116L9.56642 23.2653C9.61317 23.8096 9.82528 24.3527 10.2066 24.833C10.5897 25.3156 11.1317 25.7182 11.791 25.9736L11.9261 26.026L12.0524 26.0973C12.1986 26.1799 12.3426 26.2657 12.4843 26.3546L12.4781 26.3592C15.1968 28.0179 16.3504 30.4319 16.742 31.6663H17.354V24.3727L15.1507 22.4142L13.6552 23.9098C13.2647 24.3003 12.6315 24.3003 12.241 23.9098C11.8505 23.5193 11.8505 22.8861 12.241 22.4956L14.0328 20.7037L13.4952 17.7468L11.0593 16.5289C10.5653 16.2819 10.3651 15.6812 10.6121 15.1872C10.8591 14.6933 11.4598 14.493 11.9538 14.74L14.3306 15.9285L17.242 14.0758L16.3365 11.6609C16.1425 11.1438 16.4046 10.5674 16.9217 10.3734C17.4388 10.1795 18.0152 10.4415 18.2091 10.9586L19.1822 13.5535H20.2587L20.7729 12.525L19.9576 10.6225C19.74 10.1149 19.9752 9.527 20.4828 9.30944C20.9904 9.09189 21.5783 9.32704 21.7959 9.83467L22.498 11.4729L25.286 11.9798L25.2975 11.9705L27.0994 10.5289C27.5307 10.1839 28.16 10.2538 28.505 10.6851C28.85 11.1163 28.7801 11.7456 28.3488 12.0906L27.1443 13.0543L28.4794 14.7709L28.9921 13.7457C29.1614 13.4069 29.5077 13.1929 29.8865 13.1929H32.0488C32.6011 13.1929 33.0488 13.6406 33.0488 14.1929C33.0488 14.7452 32.6011 15.1929 32.0488 15.1929H30.5045L30.2364 15.7291L31.9054 16.1C31.9852 16.1178 32.0625 16.1452 32.1357 16.1818L33.5772 16.9026C34.0712 17.1495 34.2714 17.7502 34.0245 18.2442C33.7775 18.7382 33.1768 18.9384 32.6828 18.6914L31.3514 18.0257L28.228 17.3316C28.0009 17.2811 27.7984 17.153 27.6556 16.9694L25.3674 14.0274L22.5941 13.5232C22.5539 13.5563 22.5107 13.5865 22.4648 13.6135L21.8767 14.7895V15.3552H23.0391C23.1943 15.3552 23.3474 15.3914 23.4863 15.4608L26.3694 16.9024C26.8634 17.1494 27.0636 17.75 26.8166 18.244C26.5696 18.738 25.9689 18.9382 25.475 18.6912L22.803 17.3552H21.8767V18.8782C21.8767 19.4304 21.429 19.8782 20.8767 19.8782C20.3244 19.8782 19.8767 19.4304 19.8767 18.8782V16.3629L19.8767 16.3552L19.8767 16.3476V15.5535H18.6452L15.4938 17.5589L16.0326 20.5223L19.0184 23.1762C19.2318 23.366 19.354 23.638 19.354 23.9236V31.6663H20.7916V28.1003C20.7916 25.3985 22.3008 23.7402 23.1251 22.9551C23.7844 22.327 24.7748 21.7975 25.1876 21.6113C25.2696 21.4277 25.5493 20.9512 26.0118 20.5137C26.4743 20.0762 26.9545 19.6205 27.1368 19.4473C28.3747 20.1548 29.336 20.8652 29.336 20.8652C29.336 20.8652 30.6172 20.7949 31.1993 20.5606C31.6649 20.3731 32.4766 19.8522 32.8243 19.6152L34.032 20.3449Z"
              fill="currentColor"
            />
            <path d="M15 38H23V36H15V38Z" fill="currentColor" />
            <path d="M23 42H15V40H23V42Z" fill="currentColor" />
          </svg>
        </div>
      </div>
      <div
        class="trend-graph-selector__inner__element"
        [class.active]="trendFilter === 'other'"
        (click)="setTrendFilter('other')"
      >
        <div class="selector-name">Picto</div>
        <div class="selector-icon">
          <svg
            width="48"
            height="48"
            viewBox="0 0 48 48"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M24 42C33.9411 42 42 33.9411 42 24C42 14.0589 33.9411 6 24 6C14.0589 6 6 14.0589 6 24C6 33.9411 14.0589 42 24 42ZM24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z"
              fill="currentColor"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M24 37C31.1797 37 37 31.1797 37 24C37 16.8203 31.1797 11 24 11C16.8203 11 11 16.8203 11 24C11 31.1797 16.8203 37 24 37ZM24 39C32.2843 39 39 32.2843 39 24C39 15.7157 32.2843 9 24 9C15.7157 9 9 15.7157 9 24C9 32.2843 15.7157 39 24 39Z"
              fill="currentColor"
            />
          </svg>
        </div>
      </div>
      <div
        class="trend-graph-selector__inner__element"
        [class.active]="trendFilter === 'all'"
        (click)="setTrendFilter('all')"
      >
        <div class="selector-name">All</div>
        <div class="selector-icon">
          <svg
            width="48"
            height="48"
            viewBox="0 0 48 48"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M24 12C25.6569 12 27 10.6569 27 9C27 7.34315 25.6569 6 24 6C22.3431 6 21 7.34315 21 9C21 10.6569 22.3431 12 24 12ZM24 14C26.7614 14 29 11.7614 29 9C29 6.23858 26.7614 4 24 4C21.2386 4 19 6.23858 19 9C19 11.7614 21.2386 14 24 14Z"
              fill="currentColor"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M17.374 18.3144C18.3174 18.494 19 19.3188 19 20.2792L19 41C19 41.5523 19.4477 42 20 42H20.0868C20.604 42 21.0359 41.6056 21.0827 41.0905L22 31C22.0029 29.8975 22.8975 29.0052 24 29.0052C25.1025 29.0052 25.9971 29.8974 26 30.9999L26.9173 41.0905C26.9641 41.6056 27.396 42 27.9132 42H28C28.5523 42 29 41.5523 29 41V20.3169C29 19.3564 29.6828 18.5316 30.6264 18.3521C32.3824 18.0182 34.2392 17.5548 36.2798 16.9601C36.8101 16.8056 37.1146 16.2505 36.9601 15.7202C36.8056 15.19 36.2505 14.8855 35.7202 15.04C31.0861 16.3906 27.5307 17.0156 24.0043 16.9998C20.4743 16.9839 16.9146 16.3259 12.2674 15.0365C11.7352 14.8888 11.1841 15.2005 11.0364 15.7327C10.8888 16.2649 11.2005 16.816 11.7327 16.9636C13.7658 17.5278 15.6186 17.9803 17.374 18.3144ZM22.9779 41.8025C22.6245 43.0798 21.4552 44 20.0868 44H20C18.3431 44 17 42.6569 17 41L17 20.2792C15.1742 19.9317 13.2653 19.4645 11.1979 18.8908C9.60138 18.4478 8.66625 16.7945 9.10925 15.1979C9.55225 13.6014 11.2056 12.6663 12.8021 13.1093C17.3715 14.3772 20.7371 14.9851 24.0132 14.9998C27.2788 15.0144 30.6314 14.4399 35.1606 13.1199C36.7513 12.6563 38.4166 13.57 38.8802 15.1606C39.3438 16.7513 38.4301 18.4166 36.8394 18.8802C34.7552 19.4876 32.8345 19.9681 31 20.3169V41C31 42.6569 29.6569 44 28 44H27.9132C26.5448 44 25.3755 43.0798 25.0221 41.8025C24.9897 41.6851 24.9641 41.5647 24.9458 41.4417C24.9375 41.3856 24.9307 41.3288 24.9255 41.2716L24.0082 31.1811C24.0029 31.1223 24.0002 31.0637 24 31.0052C23.9998 31.0637 23.9971 31.1223 23.9918 31.1811L23.0745 41.2716C23.0693 41.3288 23.0625 41.3856 23.0542 41.4417C23.0359 41.5647 23.0103 41.6851 22.9779 41.8025Z"
              fill="currentColor"
            />
          </svg>
        </div>
      </div>
    </div>
  </div>

  <div class="trend-graph-container">
    <div class="trend-graph-container__menu">
      <div class="time-selectors">
        <div class="time-selectors__item" (click)="setTrendRange(5)">
          <span>5min</span>
        </div>
        <div class="time-selectors__item" (click)="setTrendRange(30)">
          <span>30min</span>
        </div>
        <div class="time-selectors__item" (click)="setTrendRange(60)">
          <span>1h</span>
        </div>
        <div class="time-selectors__item" (click)="jumpToNow()">
          <span>Now</span>
        </div>
      </div>
      <div class="timeline">
        <div class="timeline__left" (click)="shiftTrend(60)">
          <img src="../../../assets/icons/arrow-left.svg" alt="" srcset="" />
        </div>
        <div class="timeline__bar">
          <span class="timeline-tick">
            {{ formatOffsetLabel(-trendWindowSeconds) }}
          </span>
          <div
            class="timeline-position-indicator"
            [style.left.%]="(1 - trendOffsetSeconds / trendWindowSeconds) * 100"
          >
            <div class="timeline-position-marker"></div>
          </div>
          <span class="timeline-tick">00:00:00</span>
        </div>
        <div class="timeline__right" (click)="shiftTrend(-60)">
          <img src="../../../assets/icons/arrow-right.svg" alt="" srcset="" />
        </div>
      </div>
      <div class="trend-btn">
        <div class="">
          <!-- add class active -->
          <svg
            width="20"
            height="16"
            viewBox="0 0 20 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              class="stroke-col"
              d="M0.75 0.75H18.75"
              stroke="#282A33"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-dasharray="6 6"
            />
            <path
              class="stroke-col"
              d="M0.75 5.46094H18.75"
              stroke="#282A33"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-dasharray="6 6"
            />
            <path
              class="stroke-col"
              d="M0.75 10.0527H18.75"
              stroke="#282A33"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-dasharray="6 6"
            />
            <path
              class="stroke-col"
              d="M0.75 14.4004H18.75"
              stroke="#282A33"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-dasharray="6 6"
            />
          </svg>
        </div>
      </div>
    </div>
    <div class="trend-graph-container__chart-container">
      <div class="trend-graphs-list">
        <div class="timeline-overlay">
          <div class="timeline-overlay-label">
            {{ formatOffsetLabel(-trendOffsetSeconds) }}
          </div>
        </div>
        <ng-container
          *ngFor="
            let v of trendVitals | callback : filterTrendVitals;
            trackBy: trackByVitalName
          "
        >
          <div
            class="trend-row"
            (swipeleft)="pinVital(v)"
            (swiperight)="unpinVital(v)"
            [id]="v.vitalName"
          >
            <div class="trend-indicator">
              <!-- historical snapshot (left) - reuse app-vitals layout but do not subscribe to live data and hide the graph -->

              <div>
                <span>Selected</span><br />
                <app-vitals
                  [vitalName]="v.vitalName"
                  [unit]="v.unit"
                  [minVal]="v.minVal"
                  [maxVal]="v.maxVal"
                  [numVal]="getTrendCenterValue(v.vitalName, v.numVal)"
                  [size]="'xs'"
                  [color]="v.color"
                  [active]="true"
                  [subscribeLive]="false"
                  [noGraph]="true"
                ></app-vitals>
              </div>
              <!-- live value (right) - reuse app-vitals layout but hide the graph; keep live subscription enabled -->

              <div>
                <span>Realtime</span><br />
                <app-vitals
                  [vitalName]="v.vitalName"
                  [unit]="v.unit"
                  [minVal]="v.minVal"
                  [maxVal]="v.maxVal"
                  [size]="'xs'"
                  [color]="v.color"
                  [active]="true"
                  [noGraph]="true"
                  (valueChange)="onTrendValueChange(v.vitalName, $event)"
                ></app-vitals>
              </div>
            </div>

            <div class="trend-graph-area">
              <app-graph
                [vitalName]="v.vitalName"
                [color]="v.color"
                [live]="false"
                [timeWindowSeconds]="trendWindowSeconds"
                [timeOffsetSeconds]="trendOffsetSeconds"
                (valueChange)="onTrendValueChange(v.vitalName, $event)"
                (centerValueChange)="
                  onTrendCenterValueChange(v.vitalName, $event)
                "
              ></app-graph>
            </div>
            <div class="trend-pin">
              <svg
                width="12"
                height="20"
                viewBox="0 0 12 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M10 9L12 11V13H7V19L6 20L5 19V13H0V11L2 9V2H1V0H11V2H10V9ZM2.85 11H9.15L8 9.85V2H4V9.85L2.85 11Z"
                  fill="white"
                />
              </svg>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>
